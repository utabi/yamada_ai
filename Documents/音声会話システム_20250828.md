# Claude音声会話システム
作成日: 2025年8月28日

## 概要
管理者との音声会話を実現するシステムを構築しました。macOSの音声合成（Text-to-Speech）と音声認識機能を活用しています。

## システム構成

### 1. 音声出力システム（Text-to-Speech）
**ファイル**: `~/speak_to_admin.sh`

#### 機能
- **音声合成**: macOSの`say`コマンドを使用
- **音声**: Kyoko（日本語女性音声）
- **速度調整**: 可変速度対応（150-200 words/minute）

#### 使用方法
```bash
# 基本的な音声出力
~/speak_to_admin.sh speak "メッセージ"

# 音声出力＋記録
~/speak_to_admin.sh record "タイトル" "メッセージ"

# 重要通知（音声＋通知＋記録）
~/speak_to_admin.sh important "タイトル" "重要なメッセージ"

# 対話モード
~/speak_to_admin.sh interactive

# テスト
~/speak_to_admin.sh test
```

#### 特徴
- 音声速度の自動調整（重要度に応じて）
- デスクトップへの文字記録も同時実行
- ログファイルによる履歴管理
- カラー出力による視覚的フィードバック

### 2. 音声認識システム（Speech-to-Text）
**ファイル**: `~/voice_listener.py`

#### 機能
- AppleScriptを使用した音声入力ダイアログ
- 認識結果の自動保存
- 簡単な音声コマンド処理

#### 使用方法
```bash
# 音声認識システムの起動
python3 ~/voice_listener.py
```

#### 認識可能なコマンド例
- 「こんにちは」→ 挨拶を返す
- 「時間」「時刻」→ 現在時刻を音声で返答
- 「終了」「ストップ」→ システム終了

### 3. 統合音声会話フロー

```
管理者の音声
    ↓
[音声認識] voice_listener.py
    ↓
テキスト変換・保存
    ↓
コマンド処理
    ↓
[音声合成] speak_to_admin.sh
    ↓
管理者への音声応答
```

## ファイル構成

### スクリプト
- `~/speak_to_admin.sh` - 音声出力メインスクリプト
- `~/voice_listener.py` - 音声認識スクリプト
- `~/notify_admin.sh` - テキスト通知スクリプト（補助）

### ログ・記録
- `~/Documents/claude_voice_log.txt` - 音声出力ログ
- `~/Documents/claude_voice_recognition_log.txt` - 音声認識ログ
- `~/Desktop/Claude_音声メッセージ.txt` - 最新メッセージ
- `~/Desktop/Claude_音声コマンド.txt` - 最新認識コマンド

## 実装上の制限と対策

### 制限事項
1. **完全自動音声認識の制限**
   - macOSのセキュリティ制限により、常時音声監視は困難
   - 解決策：手動トリガー方式を採用

2. **音声認識精度**
   - システムの音声認識に依存
   - 解決策：認識結果を画面表示し確認可能に

3. **バックグラウンド動作**
   - CLIツールとしての制限
   - 解決策：必要時に起動する方式

### 対策済み事項
- ✅ 日本語音声の完全サポート
- ✅ ログによる会話履歴の保存
- ✅ 複数の通知方法の併用
- ✅ エラーハンドリング

## 使用例

### 例1: 作業完了通知
```bash
~/speak_to_admin.sh important "作業完了" "VSCodeのインストールが完了しました。"
```

### 例2: 定期報告
```bash
~/speak_to_admin.sh record "定期報告" "現在、システムは正常に動作しています。"
```

### 例3: 対話セッション
```bash
~/speak_to_admin.sh interactive
# 対話モードで継続的な会話が可能
```

## 今後の拡張可能性

### 短期的改善
1. より多くの音声コマンドの追加
2. 音声認識の精度向上
3. 自動起動スクリプトの作成

### 長期的拡張
1. 機械学習による文脈理解
2. 複数言語対応
3. 音声アシスタント統合

## 動作確認
- ✅ 音声合成（say コマンド）: 正常動作
- ✅ 音声出力スクリプト: 正常動作
- ✅ 音声認識スクリプト: 作成完了
- ✅ ログ記録: 正常動作
- ✅ デスクトップ通知: 正常動作

## 注意事項
- 音声認識使用時はマイクへのアクセス許可が必要
- 音量設定を適切に調整してください
- プライバシーに配慮し、音声ログは定期的に確認・削除を推奨